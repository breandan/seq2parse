import sys
from os import mkdir
from os.path import join, exists
from pathlib import Path
import json
from statistics import mean, median, stdev
from tokenize import TokenError
import difflib as df
import asttokens as toks
import matplotlib.pyplot as plt
import numpy as np
import tqdm
import re
from ecpp_individual_grammar_all_states import read_grammar, get_token_list, get_actual_token_list


def cum_dist_fun(secs, durs):
    in_set = list(filter(lambda x: x <= secs, durs))
    return len(in_set) * 100.0 / len(durs)


def dist_fun(secs, durs, step):
    in_set = list(filter(lambda x: secs - step < x <= secs, durs))
    return len(in_set) * 100.0 / len(durs)

if __name__ == "__main__":
    outDir = Path(sys.argv[1])
    MAX_SECS = 60 + 1
    # Plot CDF of fix durations of the dataset
    plt.rc('text', usetex=True)
    plt.rc('font', family='serif', size=30)
    plt.rc('legend', fontsize=22)

    fig, ax = plt.subplots(figsize=(14, 8))
    xs = list(range(0, MAX_SECS + 1))
    popular_20_cost_10_ys = list(map(lambda x: x * 0.8066796848697058, [0.0, 6.786666666666667, 15.82, 25.22, 33.22666666666667, 40.026666666666664, 45.413333333333334, 50.0, 53.553333333333335, 57.07333333333333, 59.946666666666665, 62.43333333333333, 64.52666666666667, 66.30666666666667, 68.22666666666667, 69.74666666666667, 70.84, 71.99333333333334, 73.34, 74.34666666666666, 75.26666666666667, 76.12666666666667, 76.9, 77.69333333333333, 78.45333333333333, 79.11333333333333, 79.68, 80.32666666666667, 81.0, 81.71333333333334, 82.18666666666667, 82.64666666666666, 83.18, 83.54666666666667, 83.99333333333334, 84.54, 85.03333333333333, 85.42, 85.76666666666667, 86.07333333333334, 86.33333333333333, 86.64666666666666, 87.04, 87.28, 87.57333333333334, 87.84, 88.10666666666667, 88.38, 88.63333333333334, 88.8, 89.00666666666666, 89.11333333333333, 89.25333333333333, 89.54666666666667, 89.74, 89.98, 90.26666666666667, 90.45333333333333, 90.63333333333334, 90.84666666666666, 90.98, 91.18666666666667, 91.30666666666667, 91.44666666666667, 91.56, 91.69333333333333, 91.81333333333333, 91.94666666666667, 92.1, 92.23333333333333, 92.34, 92.46, 92.55333333333333, 92.67333333333333, 92.8, 92.91333333333333, 93.02, 93.1, 93.18666666666667, 93.36, 93.43333333333334, 93.48666666666666, 93.54, 93.66, 93.76666666666667, 93.86, 93.93333333333334, 94.03333333333333, 94.16666666666667, 94.24666666666667, 94.32666666666667, 94.41333333333333, 94.5, 94.60666666666667, 94.66666666666667, 94.78, 94.82666666666667, 94.94, 95.02, 95.08, 95.14666666666666, 95.18, 95.22, 95.28666666666666, 95.36666666666666, 95.43333333333334, 95.48, 95.53333333333333, 95.60666666666667, 95.64, 95.68, 95.73333333333333, 95.79333333333334, 95.84666666666666, 95.88666666666667, 95.90666666666667, 95.94, 95.98666666666666, 96.05333333333333, 96.11333333333333, 96.18666666666667, 96.24666666666667, 96.26, 96.31333333333333, 96.33333333333333, 96.36, 96.41333333333333, 96.46666666666667, 96.52666666666667, 96.58666666666667, 96.60666666666667, 96.64666666666666, 96.68, 96.70666666666666, 96.74666666666667, 96.76666666666667, 96.76666666666667, 96.8, 96.82, 96.84666666666666, 96.88, 96.9, 96.94, 96.95333333333333, 97.02, 97.04666666666667, 97.08666666666667, 97.10666666666667, 97.12666666666667, 97.16, 97.20666666666666, 97.22666666666667, 97.24, 97.26, 97.28666666666666, 97.30666666666667, 97.32666666666667, 97.35333333333334, 97.37333333333333, 97.4, 97.42, 97.46666666666667, 97.50666666666666, 97.55333333333333, 97.58, 97.60666666666667, 97.62666666666667, 97.63333333333334, 97.66, 97.66666666666667, 97.68, 97.71333333333334, 97.72666666666667, 97.78, 97.78666666666666, 97.8, 97.80666666666667, 97.81333333333333, 97.82, 97.83333333333333, 97.85333333333334, 97.85333333333334, 97.87333333333333, 97.88666666666667, 97.89333333333333, 97.9, 97.92666666666666, 97.96, 97.96666666666667, 97.97333333333333, 97.98666666666666, 98.0, 98.00666666666666, 98.02666666666667, 98.04666666666667, 98.05333333333333, 98.08, 98.08666666666667, 98.10666666666667, 98.12666666666667, 98.13333333333334, 98.13333333333334, 98.14666666666666, 98.17333333333333, 98.17333333333333, 98.19333333333333, 98.20666666666666, 98.22, 98.23333333333333, 98.25333333333333, 98.25333333333333, 98.26666666666667, 98.3, 98.3, 98.31333333333333, 98.32666666666667, 98.34666666666666, 98.36, 98.37333333333333, 98.38, 98.38666666666667, 98.39333333333333, 98.42666666666666, 98.42666666666666, 98.44, 98.44666666666667, 98.46, 98.47333333333333, 98.49333333333334, 98.50666666666666, 98.52666666666667, 98.54, 98.55333333333333, 98.56666666666666, 98.58666666666667, 98.59333333333333, 98.61333333333333, 98.61333333333333, 98.63333333333334, 98.64, 98.66666666666667, 98.68666666666667, 98.70666666666666, 98.72, 98.73333333333333, 98.74, 98.75333333333333, 98.75333333333333, 98.75333333333333, 98.76, 98.77333333333333, 98.79333333333334, 98.8, 98.8, 98.8, 98.80666666666667, 98.81333333333333, 98.81333333333333, 98.82666666666667, 98.82666666666667, 98.84, 98.84, 98.84, 98.84666666666666, 98.85333333333334, 98.85333333333334, 98.85333333333334, 98.85333333333334, 98.86, 98.87333333333333, 98.88666666666667, 98.88666666666667, 98.88666666666667, 98.88666666666667, 98.88666666666667, 98.89333333333333, 98.9, 98.90666666666667, 98.91333333333333, 98.92, 98.92, 98.92, 98.92, 98.92666666666666, 98.92666666666666, 98.93333333333334, 98.94666666666667, 98.95333333333333, 98.95333333333333, 98.95333333333333, 98.96, 98.96, 98.96666666666667, 98.96666666666667, 98.97333333333333, 98.99333333333334, 99.0, 99.0, 99.0, 99.00666666666666, 100.0]))
    popular_50_cost_10_ys = list(map(lambda x: x * 0.9563021673563864, [0.0, 3.3333333333333335, 7.073333333333333, 12.093333333333334, 17.06, 22.106666666666666, 26.32, 30.413333333333334, 34.42, 37.78666666666667, 40.82666666666667, 43.42, 45.973333333333336, 48.57333333333333, 50.88666666666666, 52.88, 54.64666666666667, 56.16, 57.49333333333333, 59.03333333333333, 60.22666666666667, 61.29333333333334, 62.36, 63.36666666666667, 64.46666666666667, 65.54666666666667, 66.41333333333333, 67.38666666666667, 68.2, 68.89333333333333, 69.61333333333333, 70.22, 70.86666666666666, 71.42666666666666, 71.96, 72.54666666666667, 73.16, 73.72666666666667, 74.26, 74.79333333333334, 75.21333333333334, 75.55333333333333, 75.95333333333333, 76.33333333333333, 76.76666666666667, 77.22666666666667, 77.53333333333333, 77.84, 78.12666666666667, 78.44, 78.76666666666667, 79.07333333333334, 79.27333333333333, 79.51333333333334, 79.81333333333333, 80.02, 80.27333333333333, 80.52666666666667, 80.86666666666666, 81.12, 81.33333333333333, 81.6, 81.86, 82.07333333333334, 82.30666666666667, 82.49333333333334, 82.66, 82.82, 83.02666666666667, 83.20666666666666, 83.36, 83.54666666666667, 83.75333333333333, 83.94666666666667, 84.12, 84.28, 84.42666666666666, 84.60666666666667, 84.79333333333334, 84.94, 85.13333333333334, 85.24666666666667, 85.41333333333333, 85.53333333333333, 85.68666666666667, 85.80666666666667, 85.92, 86.01333333333334, 86.15333333333334, 86.26, 86.33333333333333, 86.50666666666666, 86.62, 86.74, 86.81333333333333, 86.90666666666667, 87.02666666666667, 87.15333333333334, 87.24666666666667, 87.32666666666667, 87.41333333333333, 87.48666666666666, 87.56, 87.62666666666667, 87.71333333333334, 87.80666666666667, 87.97333333333333, 88.08, 88.18666666666667, 88.22666666666667, 88.32666666666667, 88.38, 88.51333333333334, 88.56, 88.64666666666666, 88.74, 88.82, 88.87333333333333, 88.97333333333333, 89.04666666666667, 89.10666666666667, 89.16666666666667, 89.24, 89.34, 89.41333333333333, 89.5, 89.54666666666667, 89.6, 89.69333333333333, 89.74666666666667, 89.84, 89.92666666666666, 89.97333333333333, 90.03333333333333, 90.06, 90.09333333333333, 90.16666666666667, 90.25333333333333, 90.32, 90.34666666666666, 90.42666666666666, 90.46, 90.53333333333333, 90.56666666666666, 90.62, 90.68666666666667, 90.78, 90.82666666666667, 90.9, 90.97333333333333, 91.00666666666666, 91.03333333333333, 91.1, 91.14666666666666, 91.19333333333333, 91.25333333333333, 91.31333333333333, 91.4, 91.46666666666667, 91.52, 91.55333333333333, 91.56, 91.58666666666667, 91.6, 91.68, 91.7, 91.74666666666667, 91.79333333333334, 91.84, 91.92, 91.95333333333333, 92.00666666666666, 92.06666666666666, 92.12, 92.14666666666666, 92.2, 92.23333333333333, 92.27333333333333, 92.31333333333333, 92.35333333333334, 92.38, 92.42666666666666, 92.46, 92.48666666666666, 92.52666666666667, 92.56, 92.58, 92.62666666666667, 92.66666666666667, 92.68666666666667, 92.73333333333333, 92.75333333333333, 92.78666666666666, 92.81333333333333, 92.82666666666667, 92.9, 92.93333333333334, 92.96, 93.00666666666666, 93.02, 93.03333333333333, 93.04666666666667, 93.06666666666666, 93.09333333333333, 93.12, 93.18666666666667, 93.20666666666666, 93.23333333333333, 93.27333333333333, 93.28666666666666, 93.31333333333333, 93.38, 93.40666666666667, 93.40666666666667, 93.42, 93.44666666666667, 93.46666666666667, 93.48, 93.51333333333334, 93.52, 93.53333333333333, 93.58, 93.62, 93.66, 93.7, 93.72666666666667, 93.73333333333333, 93.76666666666667, 93.77333333333333, 93.8, 93.8, 93.84, 93.85333333333334, 93.85333333333334, 93.86, 93.88666666666667, 93.9, 93.94666666666667, 93.95333333333333, 93.98666666666666, 94.00666666666666, 94.02666666666667, 94.05333333333333, 94.05333333333333, 94.08, 94.1, 94.13333333333334, 94.16, 94.18666666666667, 94.20666666666666, 94.21333333333334, 94.24666666666667, 94.25333333333333, 94.26, 94.28, 94.30666666666667, 94.31333333333333, 94.32666666666667, 94.34666666666666, 94.37333333333333, 94.4, 94.41333333333333, 94.43333333333334, 94.44666666666667, 94.46, 94.46666666666667, 94.48, 94.48666666666666, 94.50666666666666, 94.52, 94.54, 94.57333333333334, 94.59333333333333, 94.59333333333333, 94.60666666666667, 94.61333333333333, 94.64666666666666, 94.65333333333334, 94.66666666666667, 94.69333333333333, 94.7, 94.70666666666666, 94.73333333333333, 94.76, 94.78, 94.79333333333334, 94.83333333333333, 94.83333333333333, 94.86, 94.87333333333333, 94.88666666666667, 94.91333333333333, 94.92666666666666, 94.92666666666666, 94.94, 94.96, 94.98, 94.99333333333334, 95.01333333333334, 95.03333333333333, 100.0]))
    all_states_top_20_cost_2_ys = list(map(lambda x: x * 0.793445708907333, [0.0, 11.833333333333334, 21.88, 26.933333333333334, 30.16, 32.67333333333333, 34.48, 36.39333333333333, 37.78, 39.166666666666664, 40.233333333333334, 41.32666666666667, 42.29333333333334, 43.28, 44.25333333333333, 45.1, 45.74666666666667, 46.34, 46.92, 47.413333333333334, 47.92666666666667, 48.52, 49.266666666666666, 49.9, 50.406666666666666, 50.9, 51.346666666666664, 51.74, 52.166666666666664, 52.586666666666666, 53.00666666666667, 53.446666666666665, 53.75333333333333, 54.166666666666664, 54.68, 55.06666666666667, 55.32, 55.72666666666667, 56.13333333333333, 56.513333333333335, 56.79333333333334, 57.086666666666666, 57.446666666666665, 57.72, 58.04, 58.29333333333334, 58.5, 58.72666666666667, 58.96666666666667, 59.18, 59.34, 59.593333333333334, 59.8, 60.06, 60.333333333333336, 60.54, 60.81333333333333, 61.00666666666667, 61.28, 61.52, 61.733333333333334, 61.9, 62.1, 62.27333333333333, 62.46, 62.66, 62.84, 63.00666666666667, 63.18, 63.32666666666667, 63.513333333333335, 63.68666666666667, 63.846666666666664, 63.986666666666665, 64.12666666666667, 64.3, 64.46, 64.54666666666667, 64.67333333333333, 64.78, 64.9, 65.04666666666667, 65.18666666666667, 65.32, 65.38666666666667, 65.48666666666666, 65.64, 65.74, 65.88666666666667, 65.98, 66.14, 66.29333333333334, 66.4, 66.53333333333333, 66.70666666666666, 66.83333333333333, 66.92666666666666, 67.06, 67.16, 67.26666666666667, 67.34666666666666, 67.42666666666666, 67.53333333333333, 67.63333333333334, 67.67333333333333, 67.74, 67.85333333333334, 67.94, 68.04, 68.11333333333333, 68.19333333333333, 68.3, 68.37333333333333, 68.48666666666666, 68.58, 68.66, 68.74, 68.82666666666667, 68.95333333333333, 69.00666666666666, 69.09333333333333, 69.16, 69.24666666666667, 69.31333333333333, 69.41333333333333, 69.5, 69.57333333333334, 69.62666666666667, 69.70666666666666, 69.77333333333333, 69.82, 69.9, 69.94666666666667, 70.04, 70.13333333333334, 70.21333333333334, 70.31333333333333, 70.39333333333333, 70.51333333333334, 70.56666666666666, 70.62666666666667, 70.69333333333333, 70.76666666666667, 70.93333333333334, 71.03333333333333, 71.08666666666667, 71.16, 71.24666666666667, 71.28666666666666, 71.33333333333333, 71.41333333333333, 71.47333333333333, 71.49333333333334, 71.62, 71.64, 71.71333333333334, 71.79333333333334, 71.84666666666666, 71.9, 71.95333333333333, 72.04, 72.10666666666667, 72.16666666666667, 72.22666666666667, 72.28666666666666, 72.32666666666667, 72.37333333333333, 72.44, 72.51333333333334, 72.57333333333334, 72.69333333333333, 72.76666666666667, 72.83333333333333, 72.86666666666666, 72.92666666666666, 73.0, 73.07333333333334, 73.10666666666667, 73.16666666666667, 73.20666666666666, 73.24, 73.27333333333333, 73.34666666666666, 73.40666666666667, 73.46666666666667, 73.5, 73.53333333333333, 73.59333333333333, 73.62666666666667, 73.68666666666667, 73.78, 73.82666666666667, 73.87333333333333, 73.95333333333333, 74.00666666666666, 74.05333333333333, 74.07333333333334, 74.12, 74.15333333333334, 74.2, 74.24, 74.30666666666667, 74.34666666666666, 74.38666666666667, 74.43333333333334, 74.50666666666666, 74.54, 74.6, 74.65333333333334, 74.70666666666666, 74.72666666666667, 74.79333333333334, 74.83333333333333, 74.86, 74.9, 74.93333333333334, 74.96666666666667, 74.99333333333334, 75.04, 75.06666666666666, 75.08666666666667, 75.16, 75.18666666666667, 75.21333333333334, 75.26, 75.28, 75.30666666666667, 75.34, 75.38, 75.42, 75.44666666666667, 75.46666666666667, 75.51333333333334, 75.56, 75.57333333333334, 75.59333333333333, 75.64, 75.67333333333333, 75.70666666666666, 75.76, 75.80666666666667, 75.83333333333333, 75.88666666666667, 75.91333333333333, 75.94, 76.0, 76.03333333333333, 76.06, 76.06666666666666, 76.12, 76.18666666666667, 76.24666666666667, 76.29333333333334, 76.32, 76.34666666666666, 76.37333333333333, 76.4, 76.46666666666667, 76.47333333333333, 76.49333333333334, 76.53333333333333, 76.58666666666667, 76.62666666666667, 76.66666666666667, 76.69333333333333, 76.74, 76.77333333333333, 76.78666666666666, 76.82, 76.84666666666666, 76.89333333333333, 76.93333333333334, 76.95333333333333, 76.98666666666666, 77.04, 77.07333333333334, 77.12, 77.16, 77.19333333333333, 77.23333333333333, 77.25333333333333, 77.27333333333333, 77.32666666666667, 77.36, 77.39333333333333, 77.42, 77.43333333333334, 77.46666666666667, 77.48666666666666, 77.52666666666667, 77.57333333333334, 77.58666666666667, 77.64666666666666, 77.68, 77.72, 77.72666666666667, 77.76, 77.81333333333333, 77.83333333333333, 77.88, 100.0]))
    top_1_top_20_cost_10_ys = list(map(lambda x: x * 0.9529522782421138, [0.0, 8.233333333333333, 20.84, 32.12, 41.03333333333333, 48.306666666666665, 54.346666666666664, 59.16, 62.63333333333333, 65.6, 68.56666666666666, 70.83333333333333, 72.62, 74.45333333333333, 75.92, 77.16666666666667, 78.29333333333334, 79.36, 80.26, 81.08666666666667, 81.96, 82.74, 83.46, 84.08, 84.56, 85.07333333333334, 85.47333333333333, 85.94666666666667, 86.34666666666666, 86.72666666666667, 87.13333333333334, 87.51333333333334, 87.88666666666667, 88.24666666666667, 88.58, 88.78666666666666, 88.99333333333334, 89.27333333333333, 89.56666666666666, 89.83333333333333, 90.05333333333333, 90.21333333333334, 90.41333333333333, 90.54666666666667, 90.77333333333333, 90.99333333333334, 91.14, 91.34666666666666, 91.44, 91.56666666666666, 91.72, 91.86666666666666, 92.0, 92.16, 92.32, 92.46666666666667, 92.6, 92.77333333333333, 92.93333333333334, 93.07333333333334, 93.2, 93.34, 93.47333333333333, 93.62666666666667, 93.70666666666666, 93.79333333333334, 93.84, 93.91333333333333, 94.0, 94.10666666666667, 94.16, 94.22666666666667, 94.28, 94.34, 94.41333333333333, 94.5, 94.57333333333334, 94.64, 94.70666666666666, 94.76, 94.85333333333334, 94.92, 94.97333333333333, 95.04, 95.10666666666667, 95.15333333333334, 95.24, 95.32, 95.40666666666667, 95.48, 95.52, 95.58, 95.62666666666667, 95.68666666666667, 95.74, 95.78, 95.82, 95.88666666666667, 95.94666666666667, 95.98666666666666, 96.04, 96.05333333333333, 96.10666666666667, 96.18666666666667, 96.2, 96.22, 96.27333333333333, 96.32, 96.34, 96.36666666666666, 96.41333333333333, 96.48, 96.52666666666667, 96.55333333333333, 96.58, 96.61333333333333, 96.66666666666667, 96.72, 96.72666666666667, 96.74666666666667, 96.79333333333334, 96.84, 96.86, 96.88, 96.88, 96.90666666666667, 96.92666666666666, 96.97333333333333, 97.03333333333333, 97.08, 97.10666666666667, 97.13333333333334, 97.18666666666667, 97.22, 97.24666666666667, 97.27333333333333, 97.29333333333334, 97.32, 97.36, 97.36666666666666, 97.39333333333333, 97.40666666666667, 97.43333333333334, 97.45333333333333, 97.46, 97.48, 97.5, 97.52666666666667, 97.54, 97.55333333333333, 97.56666666666666, 97.58, 97.61333333333333, 97.66666666666667, 97.68666666666667, 97.70666666666666, 97.70666666666666, 97.71333333333334, 97.74666666666667, 97.75333333333333, 97.76, 97.78, 97.78, 97.78666666666666, 97.80666666666667, 97.80666666666667, 97.82, 97.83333333333333, 97.85333333333334, 97.88, 97.88666666666667, 97.9, 97.91333333333333, 97.93333333333334, 97.94, 97.97333333333333, 97.99333333333334, 98.0, 98.0, 98.0, 98.0, 98.02666666666667, 98.02666666666667, 98.03333333333333, 98.04666666666667, 98.06666666666666, 98.07333333333334, 98.08666666666667, 98.08666666666667, 98.1, 98.10666666666667, 98.10666666666667, 98.11333333333333, 98.12666666666667, 98.13333333333334, 98.13333333333334, 98.15333333333334, 98.16666666666667, 98.16666666666667, 98.16666666666667, 98.18666666666667, 98.19333333333333, 98.2, 98.20666666666666, 98.20666666666666, 98.22, 98.22, 98.22666666666667, 98.24, 98.26666666666667, 98.27333333333333, 98.28, 98.28666666666666, 98.3, 98.32, 98.33333333333333, 98.34, 98.34666666666666, 98.35333333333334, 98.36666666666666, 98.38666666666667, 98.39333333333333, 98.4, 98.40666666666667, 98.42, 98.43333333333334, 98.44, 98.44, 98.46, 98.46666666666667, 98.48, 98.48666666666666, 98.49333333333334, 98.5, 98.52666666666667, 98.52666666666667, 98.52666666666667, 98.53333333333333, 98.54, 98.54666666666667, 98.55333333333333, 98.55333333333333, 98.56, 98.58666666666667, 98.59333333333333, 98.6, 98.60666666666667, 98.62666666666667, 98.63333333333334, 98.63333333333334, 98.64, 98.64666666666666, 98.65333333333334, 98.65333333333334, 98.66, 98.66, 98.66666666666667, 98.68, 98.68666666666667, 98.7, 98.70666666666666, 98.72, 98.72, 98.72, 98.72, 98.73333333333333, 98.74, 98.74, 98.76, 98.76666666666667, 98.77333333333333, 98.78, 98.78, 98.78, 98.78, 98.78666666666666, 98.79333333333334, 98.8, 98.8, 98.8, 98.81333333333333, 98.82, 98.82666666666667, 98.82666666666667, 98.83333333333333, 98.84, 98.84666666666666, 98.85333333333334, 98.85333333333334, 98.86, 98.88, 98.88666666666667, 98.88666666666667, 98.88666666666667, 98.88666666666667, 98.89333333333333, 98.89333333333333, 98.89333333333333, 98.89333333333333, 98.90666666666667, 100.0]))
    top_1_best_cost_10_ys = list(map(lambda x: x * 0.94850621013763, [0.0, 33.586666666666666, 49.086666666666666, 57.86666666666667, 63.413333333333334, 67.78, 70.98666666666666, 73.52666666666667, 75.7, 77.44, 79.16666666666667, 80.42666666666666, 81.47333333333333, 82.48666666666666, 83.34, 84.14, 84.78, 85.52, 86.02666666666667, 86.68666666666667, 87.12666666666667, 87.54666666666667, 87.96, 88.38666666666667, 88.69333333333333, 89.03333333333333, 89.45333333333333, 89.82666666666667, 90.14666666666666, 90.38, 90.62666666666667, 90.89333333333333, 91.14666666666666, 91.41333333333333, 91.6, 91.81333333333333, 91.97333333333333, 92.18, 92.31333333333333, 92.48, 92.58, 92.74666666666667, 92.84, 92.98, 93.13333333333334, 93.33333333333333, 93.5, 93.60666666666667, 93.76, 93.9, 94.02, 94.15333333333334, 94.22666666666667, 94.33333333333333, 94.42, 94.52, 94.62666666666667, 94.74666666666667, 94.84666666666666, 94.93333333333334, 95.01333333333334, 95.09333333333333, 95.20666666666666, 95.30666666666667, 95.36666666666666, 95.44, 95.50666666666666, 95.57333333333334, 95.62666666666667, 95.67333333333333, 95.68666666666667, 95.75333333333333, 95.78, 95.86, 95.94666666666667, 96.0, 96.04666666666667, 96.11333333333333, 96.16666666666667, 96.2, 96.24, 96.28, 96.33333333333333, 96.38666666666667, 96.40666666666667, 96.44666666666667, 96.5, 96.55333333333333, 96.6, 96.62666666666667, 96.66, 96.71333333333334, 96.76, 96.79333333333334, 96.82666666666667, 96.84666666666666, 96.90666666666667, 96.94666666666667, 97.00666666666666, 97.03333333333333, 97.08666666666667, 97.12666666666667, 97.14, 97.18666666666667, 97.2, 97.22666666666667, 97.26, 97.27333333333333, 97.28666666666666, 97.32, 97.34, 97.38, 97.38666666666667, 97.41333333333333, 97.43333333333334, 97.47333333333333, 97.48666666666666, 97.5, 97.51333333333334, 97.53333333333333, 97.56, 97.58, 97.6, 97.62666666666667, 97.64666666666666, 97.64666666666666, 97.66666666666667, 97.68, 97.69333333333333, 97.72, 97.74, 97.75333333333333, 97.77333333333333, 97.79333333333334, 97.80666666666667, 97.83333333333333, 97.85333333333334, 97.86, 97.89333333333333, 97.92666666666666, 97.94666666666667, 97.98666666666666, 97.99333333333334, 98.04, 98.05333333333333, 98.07333333333334, 98.08, 98.10666666666667, 98.13333333333334, 98.13333333333334, 98.17333333333333, 98.20666666666666, 98.24, 98.26, 98.28, 98.29333333333334, 98.29333333333334, 98.29333333333334, 98.3, 98.3, 98.32, 98.32, 98.32666666666667, 98.34666666666666, 98.35333333333334, 98.36666666666666, 98.38, 98.42, 98.42, 98.42, 98.42666666666666, 98.43333333333334, 98.46666666666667, 98.46666666666667, 98.47333333333333, 98.48, 98.5, 98.51333333333334, 98.52666666666667, 98.54, 98.56, 98.56, 98.57333333333334, 98.57333333333334, 98.58, 98.58, 98.58, 98.59333333333333, 98.6, 98.60666666666667, 98.62666666666667, 98.64, 98.64, 98.65333333333334, 98.68666666666667, 98.69333333333333, 98.71333333333334, 98.73333333333333, 98.73333333333333, 98.74, 98.76, 98.76666666666667, 98.77333333333333, 98.78, 98.78666666666666, 98.78666666666666, 98.80666666666667, 98.82666666666667, 98.83333333333333, 98.84, 98.85333333333334, 98.86666666666666, 98.88, 98.88, 98.88666666666667, 98.9, 98.9, 98.90666666666667, 98.91333333333333, 98.91333333333333, 98.93333333333334, 98.93333333333334, 98.94, 98.94, 98.94, 98.94, 98.94666666666667, 98.96, 98.97333333333333, 98.98, 98.98666666666666, 98.99333333333334, 98.99333333333334, 99.0, 99.0, 99.0, 99.0, 99.00666666666666, 99.00666666666666, 99.00666666666666, 99.01333333333334, 99.02, 99.04, 99.05333333333333, 99.06666666666666, 99.06666666666666, 99.08666666666667, 99.1, 99.12, 99.12, 99.12666666666667, 99.12666666666667, 99.12666666666667, 99.12666666666667, 99.12666666666667, 99.12666666666667, 99.12666666666667, 99.12666666666667, 99.12666666666667, 99.12666666666667, 99.13333333333334, 99.13333333333334, 99.14666666666666, 99.15333333333334, 99.15333333333334, 99.15333333333334, 99.16, 99.16666666666667, 99.16666666666667, 99.18, 99.18, 99.18, 99.18666666666667, 99.19333333333333, 99.2, 99.20666666666666, 99.21333333333334, 99.23333333333333, 99.23333333333333, 99.23333333333333, 99.24, 99.24, 99.24666666666667, 99.24666666666667, 99.24666666666667, 99.26, 99.26, 99.26, 99.26, 99.26666666666667, 99.27333333333333, 99.27333333333333, 99.27333333333333, 99.27333333333333, 99.28, 99.28666666666666, 99.29333333333334, 99.29333333333334, 99.29333333333334, 99.3, 100.0]))

    ax.plot(xs, popular_20_cost_10_ys[:(MAX_SECS+1)], linewidth=3.0, label='20 Most Popular')
    ax.plot(xs, popular_50_cost_10_ys[:(MAX_SECS+1)], linewidth=3.0, label='50 Most Popular')
    ax.plot(xs, all_states_top_20_cost_2_ys[:(MAX_SECS+1)], linewidth=3.0, label='\\textsc{AllParses}')
    ax.plot(xs, top_1_top_20_cost_10_ys[:(MAX_SECS+1)], linewidth=3.0, label='\\textsc{MinimumCost}')
    ax.plot(xs, top_1_best_cost_10_ys[:(MAX_SECS+1)], linewidth=3.0, label='\\textsc{Threshold}')

    print("popular_20_cost_10_ys[20] =", popular_20_cost_10_ys[21])
    print("popular_50_cost_10_ys[20] =", popular_50_cost_10_ys[21])
    print("all_states_top_20_cost_2_ys[20] =", all_states_top_20_cost_2_ys[21])
    print("top_1_top_20_cost_10_ys[20] =", top_1_top_20_cost_10_ys[21])
    print("top_1_best_cost_10_ys[20] =", top_1_best_cost_10_ys[21])

    ax.set_xlim([0, MAX_SECS-1])
    ax.set_ylim([0, 100])

    ax.grid(True, which='both')
    ax.legend(loc='lower right')
    ax.set_xlabel('Repair Time (sec.)')
    ax.set_ylabel('Repair Rate (\%)')

    plt.minorticks_on()
    plt.grid(True, which='minor', linestyle='--')
    plt.tight_layout()
    # plt.show()
    plt.savefig(join(outDir, "tool-repair-rate.png"))
    plt.savefig(join(outDir, "tool-repair-rate.pdf"))

    token_chngs_accs = [(1, 97.66536964980544), (2, 97.59341355288157), (3, 96.04974396488662), (4, 95.71550985432734), (5, 92.643391521197), (6, 95.08506616257088), (7, 90.35639412997904), (8, 93.89763779527559), (9, 91.81286549707602)]
    token_chngs_accs_rest = [(10, 92.53731343283582), (11, 90.9090909090909), (12, 92.22222222222223), (13, 92.39543726235742), (14, 92.41706161137441), (15, 92.97297297297297), (16, 89.6103896103896), (17, 89.47368421052632), (18, 85.02994011976048), (19, 87.68115942028986), (20, 87.02290076335878), (21, 88.88888888888889), (22, 91.30434782608695), (23, 91.83673469387755), (24, 71.71717171717172), (25, 84.33734939759036), (26, 86.66666666666667), (27, 83.33333333333333), (28, 83.87096774193549), (29, 88.52459016393442), (30, 86.20689655172414), (31, 73.07692307692308), (32, 78.94736842105263), (33, 85.24590163934427), (34, 72.34042553191489), (35, 88.23529411764706), (36, 68.18181818181819), (37, 62.5), (38, 86.66666666666667), (39, 90.47619047619048), (40, 68.18181818181819)]

    fig, ax = plt.subplots(figsize=(12, 10))
    labels = list(map(lambda d: str(d[0]), token_chngs_accs))
    labels.append("10+")
    ys = list(map(lambda d: d[1], token_chngs_accs))
    ys.append(mean(list(map(lambda d: d[1], token_chngs_accs_rest))))
    width = 0.42
    xs = np.arange(len(labels))

    ax.bar(xs, ys, width, zorder=3)

    ax.grid(zorder=0)
    ax.set_xlabel('Num. of Changed Tokens')
    ax.set_ylabel('Repair Accuracy (\%)')
    ax.set_xticks(xs)
    ax.set_xticklabels(labels)
    ax.set_ylim([0, max(ys) + 5])

    # plt.minorticks_on()
    plt.grid(True, which='major', linewidth=1.5)
    # plt.grid(True, which='minor', linestyle='--')
    plt.tight_layout()
    # plt.show()
    plt.savefig(join(outDir, "accuracy-per-change.png"))
    plt.savefig(join(outDir, "accuracy-per-change.pdf"))
