% colors from http://colorbrewer2.org/?type=sequential&scheme=Blues&n=3
\definecolor{blue1}{HTML}{DEEBF7}
\definecolor{blue2}{HTML}{9ECAE1}
\definecolor{blue3}{HTML}{3182BD}
\definecolor{green1}{HTML}{E5F5E0}
\definecolor{green2}{HTML}{A1D99B}
\definecolor{green3}{HTML}{31A354}

\begin{figure}[t]
\centering
\begin{tikzpicture}
\begin{axis}[
  ybar stacked,
  width=0.8\linewidth,
  height=8cm,
  % title={Accuracy of Repair Template Prediction},
  ylabel={Accuracy},
  bar width=0.9cm,
  ymin=0.0,
  ymax=110.0,
  ytick={0.0, 10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0},
  yticklabel={\pgfmathparse{\tick}\pgfmathprintnumber{\pgfmathresult}\,\%},
  ytick style={draw=none},
  ymajorgrids = true,
  symbolic x coords={original, abstracted, abstracted-best},
  enlarge x limits=0.4,
  xtick=data,
  xtick style={draw=none},
  xticklabels={\textsc{Original}\xspace, \textsc{Abstracted}\xspace, \textsc{Threshold}\xspace},
  %x tick label style={rotate=45, anchor=north east},
  x tick label style={font=\small},
  y tick label style={font=\small},
  reverse legend,
  transpose legend,
  legend style={legend pos = north west, legend columns=4, font=\small},
]

\addplot[draw=black, fill=blue2, bar shift=-.451cm, postaction= { pattern=dots }] coordinates {(original, 0.0) (abstracted, 0.0) (abstracted-best, 79.45851707517178)};

\resetstackedplots

\addplot[draw=black, fill=green2, bar shift=.451cm, postaction= { pattern=dots }] coordinates {(original, 0.0) (abstracted, 0.0) (abstracted-best, 72.46065808297568)};

\resetstackedplots

\addplot[draw=black, fill=green1, bar shift=.451cm] coordinates {(original, 28) (abstracted, 61.23032904148784) (abstracted-best, 0.0)};
\addlegendentry{Top-10}
\addplot[draw=black, fill=green2, bar shift=.451cm] coordinates {(original, 16) (abstracted, 12.875536480686698) (abstracted-best, 0.0)};
\addlegendentry{Top-20}
\addplot[draw=black, fill=green3, bar shift=.451cm] coordinates {(original, 19) (abstracted, 11.587982832618025) (abstracted-best, 0.0)};
\addlegendentry{Top-50}
\addlegendimage{empty legend}
\addlegendentry{Rare}

\resetstackedplots

\addplot[draw=black, fill=blue1, bar shift=-.451cm] coordinates {(original, 32.34) (abstracted, 66.8136601374218) (abstracted-best, 0.0)};
\addlegendentry{Top-10}
\addplot[draw=black, fill=blue2, bar shift=-.451cm] coordinates {(original, 18.82) (abstracted, 11.321915700953738) (abstracted-best, 0.0)};
\addlegendentry{Top-20}
\addplot[draw=black, fill=blue3, bar shift=-.451cm] coordinates {(original, 22.80) (abstracted, 12.928588520835476) (abstracted-best, 0.0)};
\addlegendentry{Top-50}
\addlegendimage{empty legend}
\addlegendentry{All}

\end{axis}
\end{tikzpicture}
\caption{
  Results of our error production rule prediction classifiers for the simple original token sequences and their abstracted versions using the PCFG.
}
\label{fig:accuracy-results}
\end{figure}
